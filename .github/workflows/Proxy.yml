# TÃªn cá»§a workflow, sáº½ hiá»ƒn thá»‹ trong tab "Actions" cá»§a repository
name: ğŸ…¾ï¸ Proxy Tá»± Ä‘á»™ng 5m

# Äiá»u kiá»‡n Ä‘á»ƒ kÃ­ch hoáº¡t workflow
on:
  # Cháº¡y tá»± Ä‘á»™ng theo lá»‹ch trÃ¬nh (sá»­ dá»¥ng cÃº phÃ¡p cron)
  schedule:
    # Cháº¡y má»—i 5 phÃºt má»™t láº§n. ÄÃ¢y lÃ  táº§n suáº¥t tá»‘i thiá»ƒu cá»§a GitHub.
    - cron: '*/5 * * * *'
  
  # Cho phÃ©p cháº¡y thá»§ cÃ´ng tá»« tab "Actions" Ä‘á»ƒ kiá»ƒm tra
  workflow_dispatch:

# CÃ¡c cÃ´ng viá»‡c (jobs) sáº½ Ä‘Æ°á»£c thá»±c thi
jobs:
  update-proxies:
    # Sá»­ dá»¥ng mÃ¡y áº£o Ubuntu phiÃªn báº£n má»›i nháº¥t Ä‘á»ƒ cháº¡y job
    runs-on: ubuntu-latest

    # Cáº¥p quyá»n cho Action Ä‘á»ƒ cÃ³ thá»ƒ ghi (commit & push) vÃ o repository
    permissions:
      contents: write

    # CÃ¡c bÆ°á»›c thá»±c thi cá»§a job
    steps:
      # BÆ°á»›c 1: Checkout code tá»« repository vá» mÃ¡y áº£o
      # Äiá»u nÃ y cáº§n thiáº¿t Ä‘á»ƒ cÃ³ thá»ƒ chá»‰nh sá»­a file proxy.txt
      - name: Checkout repository
        uses: actions/checkout@v4

      # BÆ°á»›c 2: Táº£i danh sÃ¡ch proxy má»›i vÃ  ghi Ä‘Ã¨ vÃ o file proxy.txt
      # Dáº¥u ">" sáº½ xÃ³a ná»™i dung cÅ© vÃ  ghi ná»™i dung má»›i vÃ o file.
      - name: Táº£i danh sÃ¡ch proxy má»›i
        run: |
          curl "https://api.proxyscrape.com/v4/free-proxy-list/get?request=display_proxies&proxy_format=protocolipport&format=text" > proxy.txt

      # BÆ°á»›c 3: Commit vÃ  Ä‘áº©y cÃ¡c thay Ä‘á»•i lÃªn repository
      # Sá»­ dá»¥ng má»™t action cÃ³ sáºµn Ä‘á»ƒ tá»± Ä‘á»™ng hÃ³a viá»‡c commit
      - name: Commit vÃ  Ä‘áº©y thay Ä‘á»•i
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # Ná»™i dung cá»§a commit message
          commit_message: 'CI: Cáº­p nháº­t danh sÃ¡ch proxy tá»± Ä‘á»™ng'
          
          # Chá»‰ commit file proxy.txt náº¿u cÃ³ thay Ä‘á»•i
          file_pattern: proxy.txt
          
          # ThÃ´ng tin ngÆ°á»i commit (Ä‘á»ƒ biáº¿t Ä‘Ã¢y lÃ  commit tá»± Ä‘á»™ng)
          commit_user_name: GitHub Actions Bot
          commit_user_email: actions@github.com
